<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<script src='file:///android_asset/app.js'></script>
<link href="css/all.css" rel="stylesheet">

<link href="css/bootstrap-grid.css" rel="stylesheet">
<link href="css/bootstrap-grid.css.map" rel="stylesheet">
<link href="css/bootstrap-grid.min.css" rel="stylesheet">
<link href="css/bootstrap-grid.min.css.map" rel="stylesheet">

<link href="css/bootstrap-grid.rtl.css" rel="stylesheet">
<link href="css/bootstrap-grid.rtl.css.map" rel="stylesheet">
<link href="css/bootstrap-grid.rtl.min.css" rel="stylesheet">
<link href="css/bootstrap-grid.rtl.min.css.map" rel="stylesheet">

<link href="css/bootstrap-reboot.css" rel="stylesheet">
<link href="css/bootstrap-reboot.css.map" rel="stylesheet">
<link href="css/bootstrap-reboot.min.css" rel="stylesheet">
<link href="css/bootstrap-reboot.min.css.map" rel="stylesheet">

<link href="css/bootstrap-reboot.rtl.css" rel="stylesheet">
<link href="css/bootstrap-reboot.rtl.css.map" rel="stylesheet">
<link href="css/bootstrap-reboot.rtl.min.css" rel="stylesheet">
<link href="css/bootstrap-reboot.rtl.min.css.map" rel="stylesheet">

<link href="css/bootstrap-utilities.css" rel="stylesheet">
<link href="css/bootstrap-utilities.css.map" rel="stylesheet">
<link href="css/bootstrap-utilities.min.css" rel="stylesheet">
<link href="css/bootstrap-utilities.min.css.map" rel="stylesheet">

<link href="css/bootstrap-utilities.rtl.css" rel="stylesheet">
<link href="css/bootstrap-utilities.rtl.css.map" rel="stylesheet">
<link href="css/bootstrap-utilities.rtl.min.css" rel="stylesheet">
<link href="css/bootstrap-utilities.rtl.min.css.map" rel="stylesheet">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap.css.map" rel="stylesheet">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/bootstrap.min.css.map" rel="stylesheet">

<link href="css/bootstrap.rtl.css" rel="stylesheet">
<link href="css/bootstrap.rtl.css.map" rel="stylesheet">
<link href="css/bootstrap.rtl.min.css" rel="stylesheet">
<link href="css/bootstrap.rtl.min.css.map" rel="stylesheet">    

<script src="js/all.js"></script>

<script src="js/bootstrap.bundle.js"></script>
<script src="js/bootstrap.bundle.js.map"></script>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/bootstrap.bundle.min.js.map"></script>

<script src="js/bootstrap.esm.js"></script>
<script src="js/bootstrap.esm.js.map"></script>
<script src="js/bootstrap.esm.min.js"></script>
<script src="js/bootstrap.esm.min.js.map"></script>

<script src="js/bootstrap.js"></script>
<script src="js/bootstrap.js.map"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/bootstrap.min.js.map"></script>

<style id="mystyle">
body{
height:100%;
}
.container{
display:inline-block;
margin:auto;
border-radius:20px;
padding-bottom:14px;
width:80%;
margin-top:100px;
}
#logo{
width:100px;height:100px;
background:url(logo.png);
background-size:100%;
margin-top:10px;
border-radius:50%;
box-shadow:5px 5px 5px grey, -5px -5px 5px white;

}

#user, #lock{

width:300px;
height:50px;
border-radius:20px;
}
.dropcontainer{
display:inline-block;
margin:auto;
border-radius:5px;
width:96%;
margin-top:10px;
height:35px;
}
button{

margin:10px;
border-radius:20px;
width:300px;
height:50px;
font-size:14px;

}
button:hover{
box-shadow:1px 1px 5px grey,  -1px -1px 5px white;

}
input{
width:100%;
padding-left:5px;
font-family:times;
font-weight:bold;
height:35px;
border:none;
outline:none;
background:none;
}
p{
font-family:times;font-weight:bold;
}

#foot{
font-size:14px;
margin-top:14px;}
a{text-decoration:none;outline:none;
}
i{
color:rgb(80,80,80);
}
h3{
margin-bottom:20px;
margin-top:10px;  
font-family:times;
}

::-webkit-validation-bubble-message { display: none; }
</style>


</head>

<script>  
app.SaveText("Change","usermanagement.html");
var themeColor = app.LoadText( "themeColor" );
var color = JSON.parse(themeColor);
var c1=color.c1;
var c2=color.c2;
var c3=color.c3;
var c4=color.c4;
var c5=color.c5;
var c6=color.c6;
var mytheme =app.LoadText( "mytheme" );
if (mytheme=="1")
{
document.getElementById("mystyle").innerHTML = document.getElementById("mystyle").innerHTML+" .fullBody{"
+"background: radial-gradient(ellipse farthest-corner at right bottom, #FEDB37 0%, #FDB931 8%, #9f7928 30%, #8A6E2F 40%, transparent 80%),"
+"radial-gradient(ellipse farthest-corner at left top, #FFFFFF 0%, #FFFFAC 8%, #D1B464 25%, #5d4a1f 62.5%, #5d4a1f 100%);"
+"height:100%;width:100%;margin:0;position:absolute;}"
+".mycontainer{"
+"position:relative;"
+"background: radial-gradient(ellipse farthest-corner at right bottom, #FEDB37 0%, #FDB931 8%, #9f7928 30%, #8A6E2F 40%, transparent 80%) "
+", radial-gradient(ellipse farthest-corner at left top, #FFFFFF 0%, #FFFFAC 8%, #D1B464 25%, #5d4a1f 62.5%, #5d4a1f 100%);"
+"box-shadow:4px 4px 4px #"+c3+",-4px -4px 4px #"+c2+";"
+"font-weight:bold;}"
+".myinput{"
+"margin:auto;"
+"border:none;"
+"background:#"+c1+";"
+"outline:none;"
+"box-shadow:inset 5px 5px 5px #"+c3+", inset -5px -5px 5px #"+c2+";"
+"}"
+".mybutton{"
+"border:none;"
+"box-shadow:5px 5px 5px #"+c3+", -5px -5px 5px #"+c2+";"
+"outline:none;"
+"background: radial-gradient(ellipse farthest-corner at right bottom, #FEDB37 0%, #FDB931 8%, #9f7928 30%, #8A6E2F 40%, transparent 80%) "
+", radial-gradient(ellipse farthest-corner at left top, #FFFFFF 0%, #FFFFAC 8%, #D1B464 25%, #5d4a1f 62.5%, #5d4a1f 100%);"
+"font-weight:bold;font-family:times;}"
+".mybutton:hover{"
+"box-shadow:1px 1px 5px #"+c3+",  -1px -1px 5px #"+c2+";"
+"}"
+".FAA{color:#"+c4+";}"
+".FB{color:#"+c5+";}"
+".FC{color:#"+c6+";}";
var size=app.LoadText("size").split(",");
for (i = 0; i < size.length; i++) {
document.getElementById("mystyle").innerHTML = document.getElementById("mystyle").innerHTML+" .F"+i+"{font-size:"+size[i]+"px;} ";
}
}
else
{
document.getElementById("mystyle").innerHTML = document.getElementById("mystyle").innerHTML+" body{"
+"background:#"+c1+";"
+"}"
+".mycontainer{"
+"position:relative;"
+"background:#"+c1+";"
+"box-shadow:4px 4px 4px #"+c3+",-4px -4px 4px #"+c2+";"
+"}"
+".myinput{"
+"margin:auto;"
+"border:none;"
+"background:#"+c1+";"
+"outline:none;"
+"box-shadow:inset 5px 5px 5px #"+c3+", inset -5px -5px 5px #"+c2+";"
+"}"
+".mybutton{"
+"border:none;"
+"box-shadow:5px 5px 5px #"+c3+", -5px -5px 5px #"+c2+";"
+"outline:none;"
+"background:#"+c1+"; " 
+"}"
+".mybutton:hover{"
+"box-shadow:1px 1px 5px #"+c3+",  -1px -1px 5px #"+c2+";"
+"}"
+".FAA{color:#"+app.LoadText("fontA")+";}"
+".FB{color:#"+app.LoadText("fontB")+";}"
+".FC{color:#"+app.LoadText("fontC")+";}";
var size=app.LoadText("size").split(",");
for (i = 0; i < size.length; i++) {
document.getElementById("mystyle").innerHTML = document.getElementById("mystyle").innerHTML+" .F"+i+"{font-size:"+size[i]+"px;} ";
}
}

//app.Alert(document.getElementById("mystyle").innerHTML);
</script>

<body align="center" ondragstart="return false" onselectstart="return false">
<div class="fullBody">

<div class="">
<h3 class="FAA F20">Create user</h3>


<div class="container" style="margin-top:10px;">
<p class="F12 FAA" style="text-align:left;font-weight:bold;">Name</p>                                        
  <div class=" myinput" style="margin-top:5px;">
    <input class="F15 FAA" type="text" placeholder="Name" id="uname" required pattern="[A-Za-z].{4,}">
  </div>
</div>



<div class="container" style="margin-top:10px;">
<p class="F12 FAA" style="text-align:left;font-weight:bold;">Select Desination</p>                                        
  <div class=" myinput" style="margin-top:5px;">
  <select class="F12 FAA myinput" style="outline:none;width:100%;height:35px;font-family:times;font-weight:bold;"   name="cars" id="urole">
    <option value="Admin">Admin</option>
    <option value="Manager">Manager</option>
    <option value="Engineer">Engineer</option>
    <option value="Supervisor">Supervisor</option>
    <option value="Accountant">Accountant</option>
  </select>
  </div>
</div>

<div class="container" style="margin-top:10px;">
<p class="F12 FAA" style="text-align:left;font-weight:bold;">Mobile Number</p>                                        
  <div class=" myinput" style="margin-top:5px;">
    <input class="F15 FAA" type="number" placeholder="Mobile Number" id="umobile" pattern="[6-9]{1}[0-9]{9}"required>
  </div>
</div>


<div class="container" style="margin-top:10px;">
<p class="F12 FAA" style="text-align:left;font-weight:bold;">Email</p>                                        
  <div class=" myinput" style="margin-top:5px;">
    <input class="F15 FAA" type="email" placeholder="Email" id="uemail" required>
  </div>
</div>



<div class="container" style="margin-top:10px;">
<p class="F12 FAA" style="text-align:left;font-weight:bold;">Select Project</p>                                        
  <div class=" myinput" style="margin-top:5px;">
  <select class="F12 FAA myinput" style="outline:none;width:100%;height:35px;font-family:times;font-weight:bold;"   name="cars" id="projectlist" multiple required>
  </select>
  </div>
</div>

<div class="container" style="margin-top:10px;">
<p class="F12 FAA" style="text-align:left;font-weight:bold;">Select permission</p>                                        
  <div class=" myinput" style="margin-top:5px;">
  <select class="F12 FAA myinput" style="outline:none;width:100%;height:35px;font-family:times;font-weight:bold;"   name="cars" id="permission" multiple required>
    <option value="1" id="P1" selected>1 Add project permission</option>
    <option value="2" id="P2"selected>2 Add employee permission</option>
    <option value="3" id="P3"selected>3 View employee permission</option>
    <option value="4" id="P4"selected>4 Add paid money permission</option>
    <option value="5" id="P5"selected>5 Add salary money permission</option>
    <option value="6" id="P6"selected>6 View paid money permission</option>
    <option value="7" id="P7"selected>7 View salary money permission</option>
    <option value="8" id="P8"selected>8 View project permission</option>
    <option value="9" id="P9">9 View Employee user and pass permission</option>
    <option value="10" id="P10">10 Can view file and folders</option>
    <option value="11" id="P11">11 Can delete file and folders</option>
    <option value="12" id="P12">12 Employee profile change permission</option>
    <option value="13" id="P13">13 Employee address change permission</option>
    <option value="14" id="P14">14 Employee bank account change permission</option>
    <option value="15" id="P15">15 Add paid out permission</option>
    <option value="16" id="P16">16 Can view recent paid out</option>
    <option value="17" id="P17">17 Add salary permission</option>
    <option value="18" id="P18">18 Can view recent salary</option>
    <option value="19" id="P19">19 Update paid out permission</option>
    <option value="20" id="P20">20 Update salary permission</option>
    <option value="21" id="P21">21 Delete paid out permission</option>
    <option value="22" id="P22">22 Delete salary permission</option>
    <option value="23" id="P23">23 Add work name permission</option>
    <option value="24" id="P24">24 Delete flat type permission</option>
    <option value="25" id="P25">25 Add item name permission</option>
    <option value="26" id="P26">26 Update item name permission</option>
    <option value="27" id="P27">27 Delete item name permission</option>
     <option value="28" id="P28">28 Add and update and delete stock item permission</option>
     <option value="29" id="P29">29 Issue material permission</option>
     <option value="30" id="P30">30 delete issued material permission</option>
      <option value="31" id="P31">31 can view and set project data permission</option>
      <option value="32" id="P32">32 can Accept work add request permission</option>
  </select>
  </div>
</div>

<div class="container" style="margin-top:10px;">
<p class="F12 FAA" style="text-align:left;font-weight:bold;">Password</p>                                        
  <div class=" myinput" style="margin-top:5px;">
    <input class="F15 FAA" type="text" placeholder="Password" id="upass" required pattern=".{8,}" >
  </div>
</div>

<input type="submit"  class="mybutton FAA F14" style="font-family:times;font-weight:bold;width:70%;" onclick="submit();" value="Create user">

<script>


 var  rec = JSON.parse(app.LoadText( "userDetails" ));
       var    id=rec.id;
       var    User=rec.user;
       var   token=rec.token;
 
 
 app.Execute("loader2(1);");   
	var 	req2=new XMLHttpRequest();
	req2.open("GET",app.LoadText( "url" )+"fetchproject.php?id="+id+"&user="+User+"&token="+token,true);
	req2.onreadystatechange=function(){
if(	req2.readyState==4 && 	req2.status==200){if(	req2.responseText=="ufFygf")
{  

}else{
 if (req2.responseText.trim()==1)
 {
 app.Alert( "error please relogin" );
     app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Error"}');
 }
 else if(req2.responseText.trim()==2)
 {
  app.Alert( "User is blocked" );
       app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"User is blocked"}');
 }
 else if(req2.responseText.trim()==3)
 {
  app.Alert( "Permission denied contact admin" );
       app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Permission denied"}');
 }
 else if(req2.responseText.trim()==4)
 {
  app.Alert( "Already exist this project name" );
       app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Project already exist "}');
 }
 else if(req2.responseText.trim()==5)
 {
    app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"green","msg":"Seccessfully added"}');
 }
 else
 {
 app.SaveText("msg",'{"color":"green","msg":""}');
  app.Execute("loader2(4);");   
  
     var projectdata=req2.responseText.trim().split('@');
   for(var i = 0; i < projectdata.length ;  i++)
   {
   if (projectdata[i].length<3)
   {}
   else
   {
   var  rec = JSON.parse(projectdata[i]);
   var  pid=rec.id;
   var  pname=rec.name;
   var  paddress=rec.address;
  
     document.getElementById("projectlist").innerHTML = document.getElementById("projectlist").innerHTML+'<option value="'+pid+'" id="G'+i+'"selected>'+pname+'</option>';

  
  
 }}}
}}}
	req2.send();
	
	
	
	
var	mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
var letters = /^[A-Z a-z 0-9]+$/;

function submit()
{

var uname = document.getElementById("uname").value;
var uphone = document.getElementById("umobile").value;
var uemail = document.getElementById("uemail").value;
var urole = document.getElementById("urole").value;
var upass = document.getElementById("upass").value;


	var checkboxes = document.getElementById("permission").length+1;
  
   var permission ="";
  for (var i=1; i<checkboxes; i++) {
 
 if(document.getElementById("P"+i).selected ==true)
 {
        permission =permission+document.getElementById("P"+i).value+",";
  }
  }
  
  
  	var checkboxes2 = document.getElementById("projectlist").length;
  
   var project ="";
  for (var i=0; i<checkboxes2; i++) {
 
 if(document.getElementById("G"+i).selected ==true)
 {
        project =project+document.getElementById("G"+i).value+",";
  }
  }
  
  if(uname.match(letters) && uname.length>3)
  {
    if(uphone.length==10)
  {
    if(uemail.match(mailformat))
  {
    if(upass.length>7)
  {
  

  
   app.Execute("loader2(1);");   
	var 	req3=new XMLHttpRequest();
	req3.open("GET",app.LoadText( "url" )+"createuser.php?id="+id+"&user="+User+"&token="+token+"&name="+uname+"&mobile="+uphone+"&email="+uemail+"&password="+upass+"&role="+urole+"&project="+project+"&permission="+permission,true);
	req3.onreadystatechange=function(){
if(	req3.readyState==4 && 	req3.status==200){if(	req3.responseText=="ufFygf")
{  

}else{
 if (req3.responseText.trim()==1)
 {
     app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Error"}');
 }
 else if(req3.responseText.trim()==2)
 {
       app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Permission denied "}');
 }
 else if(req3.responseText.trim()==3)
 {
       app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"User is blocked"}');
 }
 else if(req3.responseText.trim()==4)
 {
       app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Mobile already exist "}');
 }
 else if(req3.responseText.trim()==5)
 {
    app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Already exist this email"}');
 }
  else if(req3.responseText.trim()==7)
 {
     app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Error retry"}');
 }

 else
 {
 app.SaveText("msg",'{"color":"green","msg":"Seccessfully added"}');
  app.Execute("loader2(4);");   
  
 }
}}}
	req3.send();
  }
  else
  {
   app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Password must be 8 digit"}');
  }
  }
  else
  {
   app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Please input valid email"}');
  }
  }
  else
  {
   app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Mobile accepted only 10 digit"}');
  }
  }
  else
  {
   app.Execute("loader2(4);");   
   app.SaveText("msg",'{"color":"red","msg":"Please input name"}');
  }
  
  
  
  
 
  }
</script>





</div>
</body>
</html>